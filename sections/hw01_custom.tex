\documentclass[../hw_sols.tex]{subfiles}
\setlist[description]{style = unboxed, leftmargin = 0.55cm}

\begin{document}


% =============================================================
% ========================= PROBLEM A =========================
% =============================================================

\subsection*{Problem A}

A precursor to the ADFGVX cipher was the ADFGX cipher which used a table such 
as this:
\begin{center}
\begin{tabular}{ c | c c c c c }
	  & A &  D  & F & G & X \\
	\hline
	A & b &  t  & a & l & p \\
	D & d &  h  & o & z & k \\
	F & q &  f  & v & s & n \\
	G & g & i/j & c & u & x \\
	X & m &  r  & e & w & y 
\end{tabular}
\end{center}

Encrypt the phrase "neither do they spin" below. Use the grid on the left 
below to write the two-letter substitutions row-wise. Then rearrange the 
columns so that the column headers are in alphabetical order in the grid on 
the right.
\begin{center}
\begin{tabular}{ || c | c | c | c | c || }
	\hline
	\textbf{M} & \textbf{E} & \textbf{R} & \textbf{I} & \textbf{T} \\
	\hline & & & & \\ \hline & & & & \\	
	\hline & & & & \\ \hline & & & & \\
	\hline & & & & \\ \hline & & & & \\
	\hline & & & & \\ \hline
\end{tabular}
\hspace{2cm}
\begin{tabular}{ || *{5}{m{0.3cm} | } | }
	\hline & & & & \\
	\hline & & & & \\ \hline & & & & \\	
	\hline & & & & \\ \hline & & & & \\
	\hline & & & & \\ \hline & & & & \\
	\hline & & & & \\ \hline
\end{tabular}
\end{center}

Write the ciphertext by reading out the grid on the right 
column-wise.

%=== SOLUTION ===
\begin{solution}

Using the provided ADFGX table, fill out the two tables below.
\begin{center}
\begin{tabular}{ || c | c | c | c | c || }
	\hline
	\textbf{M} & \textbf{E} & \textbf{R} & \textbf{I} & \textbf{T} \\
	\hline
	F & X & X & F & G \\
	\hline
	D & A & D & D & D \\
	\hline
	X & F & X & D & D \\
	\hline
	A & D & F & A & D \\
	\hline
	D & D & X & F & X \\
	\hline
	X & F & G & A & X \\
	\hline
	G & D & F & X & \\
	\hline
\end{tabular}
\qquad {\Huge $\Rightarrow$} \qquad
\begin{tabular}{ || c | c | c | c | c || }
	\hline
	\textbf{E} & \textbf{I} & \textbf{M} & \textbf{R} & \textbf{T} \\
	\hline
	X & F & F & X & G \\
	\hline
	A & D & D & D & D \\
	\hline
	F & D & X & X & D \\
	\hline
	D & A & A & F & D \\
	\hline
	D & F & D & X & X \\
	\hline
	F & A & X & G & X \\
	\hline
	D & X & G & F & \\
	\hline
\end{tabular}
\end{center}

Thus, we have the encryption of the phrase "neither do they spin" below.
\begin{Verbatim}
CIPHER: XAFDDFDFDDAFAXFDXADXGXDXFXGFGDDDXX
\end{Verbatim}

\end{solution}


\newpage


% =============================================================
% ========================= PROBLEM B =========================
% =============================================================

\subsection*{Problem B}

Decrypt the following permutation substitution cipher.
% Cipher from file.
\VerbatimInput{verbatim/hw01/b_cipher}

%=== SOLUTION ===
\begin{solution}

The file \verb|scripts/show_outputs.c| is used to generate the frequency 
distribution.

% VSCode snippet.
\lstinputlisting[
	language = C, style = vsLight,
	linerange = {29-35},
	firstnumber = 29
	]{show_outputs.c}

\begin{tikzpicture}
\begin{axis}[
	bargraph, 
	title = {Frequency Distribution}, 
	xmin = 0, xmax = 1, 
	ymin = 0, ymax = 40, 
	symbolic x coords = {
		0,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,1
		}
	]
	\addplot table [header=false] {hw01/b_frequency};  % Values.
\end{axis}
\end{tikzpicture}

The frequency distribution is very close to that of a monoalphabetic cipher. 
We can begin to take guesses for certain letters based on the distribution. 
Notice, there is an 11-letter word repeated twice with a 5-letter prefix.

% TODO: Update texlive first.
\begin{BVerbatim}[commandchars=\\\{\}]

    CIPHER: EMGLOSUDCGDNCUSWYSFHNSFCYKDPUMLWGYICOXYSIPJCKQPKUGKMGOLICGINCGACKSNI
    plain:          e   e     t   te           e       e            e   e  e

    CIPHER: SACYKZSCKXECJCKSHYSXCGOIDPKZCNKSHICGIWYGKKGKGOLDSILKGOIUSIGLEDSPWZUG
    plain:    e  h e   e e      e      he     e                              h

    CIPHER: \textcolor{red}{FZCCNDGYYSF}  USZCNXEOJNCGYEOWEUPXEZGACGNFGLKNSACIGOIYCKXCJUCIUZC
    plain:  thee      t    he      e          h  e  t      e     e  e  e  he

    CIPHER: \textcolor{red}{FZCCNDGYYSF}  EUEKUZCSOC  \textcolor{red}{FZCCN}  CIACZEJNCSHFZEJZEGMXCYHCJUMGKUCY
    plain:  thee      t       he  e  thee   e  eh   e  th  h    e  e      e
	
\end{BVerbatim}

The prefix \verb|thee| suggests that \verb|F| probably does not correspond to 
\verb|t|. Consider the word {\color{red}\verb|wheel|} instead and use this to 
begin making some assertions and decrypt as shown below.
% Plain from file.
\VerbatimInput{verbatim/hw01/b_plain}

\end{solution}


\newpage


% =============================================================
% ========================= PROBLEM C =========================
% =============================================================

\subsection*{Problem C}

Decrypt the following Vigen√®re ciphertext using the Index of Coincidence 
method.
% Cipher from file.
\VerbatimInput{verbatim/hw01/c_cipher}

%=== SOLUTION ===
\begin{solution}

Test keyword periods and analyze their corresponding Index of Coincidences 
using functions from \verb|scripts/ioc.c|.

% VSCode snippet.
\lstinputlisting[
	language = C, style = vsLight,
	linerange = {87-120},
	firstnumber = 87
	]{ioc.c}

\newpage

The maximum of \verb|avgs| (output of \verb|getAverageIOCs|) yields 10 but 
it's clear from the results below that 20 is also a possible period.

\begin{minipage}{0.25\linewidth}
	\begin{tabular}{ c c }
		\textbf{Period} & \textbf{Avg I.C.} \\
		1 & 0.0403894 \\
		2 & 0.0433027 \\
		\vdots & \vdots \\
		7 & 0.0404037 \\
		8 & 0.0434730 \\
		9 & 0.0400959 \\
		\rowcolor{yellow!75} 10 & 0.0636256 \\
		\vdots & \vdots \\
		\rowcolor{yellow!75} 20 & 0.0619492
	\end{tabular}
\end{minipage}
\begin{minipage}{0.7\linewidth}
	\begin{tikzpicture}
	\begin{axis}[
		bargraph, 
		title = {Average I.C. for Different Key Periods}, 
		xmin = 0, xmax = 21, 
		ymin = 0, 
		bar width = 0.35cm, 
		height = 0.38\textwidth
		]
		\addplot table {hw01/c_ic_values};   % Values from file.
	\end{axis}
	\end{tikzpicture}
\end{minipage}

\vspace{0.5cm}

Choose a period of 10 and try the 26 monoalphabetic ciphers to every 10th 
letter of the ciphertext to obtain the Chi-Square statistics. This is done 
using \verb|scripts/ioc.c| (relevant parts shown below). Note that the most
current frequency distribution according to Peter Norvig in 2012 
(\url{http://norvig.com/mayzner.html}) is denoted \verb|edist|.

% VSCode snippet.
\lstinputlisting[
	language = C, style = vsLight,
	linerange = {46-54},
	firstnumber = 46
	]{ioc.c}

% VSCode snippet.
\lstinputlisting[
	language = C, style = vsLight,
	linerange = {144-163},
	firstnumber = 144
	]{ioc.c}

\newpage

The values of \verb|shift| and \verb|chi_vals| are shown below.

\begin{center}
\begin{tabular}{ c c c }
	\textbf{Key} & \textbf{Caesar Shift} & \textbf{Chi-Sq} \\
	a &	\verb|hfwrlmqdfuyryzzsyynjtjfwmstgynwrznkwlkxljkj...sgwjmfdnwbnqwjj| 
		& 1139.65 \\
	b &	\verb|gevqklpcetxqxyyrxxmisievlrsfxmvqymjvkjwkiji...rfvilecmvampvii| 
		& 3627.85 \\
	c &	\verb|fdupjkobdswpwxxqwwlhrhdukqrewlupxliujivjhih...qeuhkdbluzlouhh| 
		& 876.493 \\
	d &	\verb|ectoijnacrvovwwpvvkgqgctjpqdvktowkhtihuighg...pdtgjcaktykntgg| 
		& 4924.34 \\
	e &	\verb|dbsnhimzbqunuvvouujfpfbsiopcujsnvjgshgthfgf...ocsfibzjsxjmsff| 
		& 826.637 \\
	\rowcolor{yellow!75} f & 
		\verb|carmghlyaptmtuunttieoearhnobtirmuifrgfsgefe...nbrehayirwilree| 
		& 109.124 \\
	\vdots & \vdots & \vdots \\
	z &	\verb|igxsmnregvzszaatzzokukgxntuhzoxsaolxmlymklk...thxkngeoxcorxkk| 
		& 4619.63
\end{tabular}
\end{center}

This suggest that the letter \verb|f| was used to encode every 10th plaintext 
letter. Hence, it is likely the first letter of the keyword. The full 
Chi-Square analysis yields the keyword \verb|FLUXIONATE|.

% VSCode snippet.
\lstinputlisting[
	language = C, style = vsLight,
	linerange = {179-192},
	firstnumber = 179
	]{ioc.c}

Decrypt using \verb|scripts/ioc.c| shown above and reformat to attain the 
legible plaintext below.
% Plain from file.
\VerbatimInput{verbatim/hw01/c_plain}

\end{solution}


\newpage


% =============================================================
% ========================= PROBLEM D =========================
% =============================================================

\subsection*{Problem D}

Decrypt the following affine cipher.
% Cipher from file.
\VerbatimInput{verbatim/hw01/d_cipher}

%=== SOLUTION ===
\begin{solution}

Using some previous code, it's simple to generate the frequency distribution.

\begin{tikzpicture}
\begin{axis}[
	bargraph, 
	title = {Frequency Distribution}, 
	xmin = 0, xmax = 1, 
	ymin = 0, ymax = 35, 
	symbolic x coords = {
		0,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,1
		}
	]
	\addplot table [header=false] {hw01/d_frequency};  % Values.
\end{axis}
\end{tikzpicture}

From the frequency, it's likely that \verb|C| and \verb|B| are ciphers for 
\verb|e| and \verb|t| respectively. Assume this is true and solve the system 
below.
	\[ \begin{bmatrix} 4 & 1 \\ 19 & 1 \end{bmatrix}
	\begin{bmatrix} a \\ b \end{bmatrix}
	\equiv
	\begin{bmatrix} 2 \\ 1 \end{bmatrix} \tmod{26} 
	\qquad \Rightarrow \qquad
	\begin{bmatrix} a \\ b \end{bmatrix}
	= 
	\begin{bmatrix} 19 \\ 4 \end{bmatrix} \]

Attempt decrypting by implementing 
	\[ D([19,4],C) := 11(C-4) \equiv p \tmod{26} \]
as shown below from \verb|scripts/show_outputs.c|.

% VSCode snippet.
\lstinputlisting[
	language = C, style = vsLight,
	linerange = {45-52},
	firstnumber = 45
	]{show_outputs.c}

By introducing spacing to the plaintext generated, we see that our guess 
worked since this yields the Canadian anthem!
% Plain from file.
\VerbatimInput{verbatim/hw01/d_plain}

\end{solution}


\end{document}